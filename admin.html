<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Orthodontic</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-box h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .login-box h2 {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }

        .form-group input:focus {
            border-color: #667eea;
            outline: none;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
        }

        .login-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            text-align: left;
        }

        .dashboard {
            display: none;
            padding: 20px;
        }

        .dashboard.active {
            display: block;
        }

        .admin-header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .admin-header h1 {
            color: #667eea;
            font-size: 1.8rem;
        }

        .logout-btn {
            padding: 10px 20px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .admin-nav {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .admin-nav button {
            padding: 12px 20px;
            background: #f8f9ff;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .admin-nav button.active {
            background: #667eea;
            color: white;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .stat-card .number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
        }

        .admin-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
        }

        .admin-section.active {
            display: block;
        }

        .referrals-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .referrals-table th,
        .referrals-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .referrals-table th {
            background: #f8f9ff;
            color: #667eea;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .status-converted {
            background: #d4edda;
            color: #155724;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .status-contracted {
            background: #cce5ff;
            color: #0056b3;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .btn-action {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 0.9rem;
        }

        .btn-convert {
            background: #28a745;
            color: white;
        }

        .btn-cancel {
            background: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px;">
                <img src="logo.jpg" alt="Logo" style="width: 50px; height: 50px;">
                <h1 style="margin: 0;">ORTHODONTIC</h1>
            </div>
            <h2>Painel Administrativo</h2>
            
            <form id="loginForm">
                <div class="form-group">
                    <input type="text" id="username" placeholder="Usu√°rio" required>
                </div>
                <div class="form-group">
                    <input type="password" id="password" placeholder="Senha" required>
                </div>
                <button type="submit" class="login-btn">Entrar</button>
            </form>
            
            <div class="login-info">
                <p><strong>Usu√°rio:</strong> admin</p>
                <p><strong>Senha:</strong> 123456</p>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
        <!-- Header -->
        <div class="admin-header">
            <div style="display: flex; align-items: center; gap: 10px;">
                <img src="logo.jpg" alt="Logo" style="width: 40px; height: 40px;">
                <h1 style="margin: 0;">Painel OrthoDontic - Jundia√≠</h1>
            </div>
            <button class="logout-btn" onclick="logout()">Sair</button>
        </div>

        <!-- Navigation -->
        <div class="admin-nav">
            <button class="active" onclick="showSection('overview')">üìä Vis√£o Geral</button>
            <button onclick="showSection('referrals')">üë• Indica√ß√µes</button>
            <button onclick="showSection('payments')">üí∞ Pagamentos</button>
            <button onclick="showSection('settings')">‚öôÔ∏è Configura√ß√µes</button>
        </div>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-card">
                <h3>Total Indica√ß√µes</h3>
                <div class="number" id="totalReferrals">0</div>
            </div>
            <div class="stat-card">
                <h3>Convertidas</h3>
                <div class="number" id="convertedReferrals">0</div>
            </div>
            <div class="stat-card">
                <h3>Pendentes</h3>
                <div class="number" id="pendingReferrals">0</div>
            </div>
            <div class="stat-card">
                <h3>Total a Pagar</h3>
                <div class="number" id="totalToPay">R$ 0</div>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="admin-section active" id="overviewSection">
            <h2>üìä Vis√£o Geral do Sistema</h2>
            <p>Bem-vindo ao painel administrativo do sistema de indica√ß√µes Orthodontic!</p>
            <br>
            <h3>üìà √öltimas Atividades:</h3>
            <div id="recentActivity">
                <p>Nenhuma atividade recente...</p>
            </div>
        </div>

        <!-- Referrals Section -->
        <div class="admin-section" id="referralsSection">
            <h2>üë• Gerenciar Indica√ß√µes</h2>
            <table class="referrals-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Indicador</th>
                        <th>Telefone</th>
                        <th>Amigo</th>
                        <th>Tel. Amigo</th>
                        <th>Data</th>
                        <th>Status</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="referralsTableBody">
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 20px;">
                            Nenhuma indica√ß√£o encontrada...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Payments Section -->
       <div class="admin-section" id="paymentsSection">
    <h2>üí∞ Controle de Pagamentos</h2>
    
    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9ff; border-radius: 8px;">
        <h4>üí∏ Resumo Financeiro:</h4>
        <p>Total Pago: <strong>R$ <span id="totalPaidAmount">0</span></strong></p>
        <p>Pendente de Pagamento: <strong>R$ <span id="pendingPaymentAmount">0</span></strong></p>
    </div>
    
    <table class="referrals-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Indicador</th>
                <th>Telefone</th>
                <th>Amigo Indicado</th>
                <th>Valor</th>
                <th>Data Pagamento</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="paymentsTableBody">
            <tr>
                <td colspan="7" style="text-align: center; padding: 20px;">
                    Nenhum pagamento encontrado...
                </td>
            </tr>
        </tbody>
    </table>
</div>

        <!-- Settings Section -->
<div class="admin-section" id="settingsSection">
    <h2>‚öôÔ∏è Configura√ß√µes do Sistema</h2>
    
    <div class="form-group">
        <label>Valor por Indica√ß√£o (R$):</label>
        <input type="number" id="referralValue" value="30" min="1">
    </div>
    
    <div class="form-group">
        <label>Nome da Cl√≠nica:</label>
        <input type="text" id="clinicName" value="Orthodontic Brasil">
    </div>
    
    <button class="login-btn" onclick="saveSettings()">Salvar Configura√ß√µes</button>
    
    <hr style="margin: 30px 0; border: 1px solid #ddd;">
    
    <h3 style="color: #dc3545; margin-bottom: 15px;">üö® Zona de Perigo</h3>
    
    <div style="background: #f8d7da; padding: 20px; border-radius: 8px; border-left: 4px solid #dc3545;">
        <p><strong>‚ö†Ô∏è ATEN√á√ÉO:</strong> As op√ß√µes abaixo s√£o irrevers√≠veis!</p>
        
        <div style="margin-top: 15px;">
            <button class="btn-action btn-cancel" onclick="resetAllData()" style="margin-right: 10px;">
                üóëÔ∏è Apagar Todas as Indica√ß√µes
            </button>
            
            <button class="btn-action btn-cancel" onclick="resetSystem()" style="background: #6c757d;">
                üîÑ Reset Completo do Sistema
            </button>
        </div>
        
        <div style="margin-top: 15px; font-size: 0.9rem; color: #721c24;">
            <p><strong>Apagar Indica√ß√µes:</strong> Remove apenas as indica√ß√µes, mant√©m configura√ß√µes</p>
            <p><strong>Reset Completo:</strong> Apaga tudo e volta √†s configura√ß√µes originais</p>
        </div>
    </div>
</div>    </div>
    <script>
        // Credenciais do admin
        const ADMIN_CREDENTIALS = {
            username: 'admin',
            password: '123456'
        };

        // Verificar se est√° logado
        let isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';

        // Fun√ß√£o de login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                localStorage.setItem('adminLoggedIn', 'true');
                showDashboard();
            } else {
                alert('‚ùå Usu√°rio ou senha incorretos!');
            }
        });

        // Mostrar dashboard
        function showDashboard() {
    document.getElementById('loginContainer').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    loadStats();
    loadReferrals();
    loadRecentActivity();
}

        // Mostrar login
        function showLogin() {
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
        }

        // Logout
        function logout() {
            localStorage.removeItem('adminLoggedIn');
            showLogin();
        }

        // Carregar estat√≠sticas
        function loadStats() {
            const referrals = JSON.parse(localStorage.getItem('referrals')) || [];
            
            const total = referrals.length;
            const converted = referrals.filter(r => r.status === 'paid').length;
            const pending = referrals.filter(r => r.status === 'pending').length;
            const totalToPay = converted * 30;

            document.getElementById('totalReferrals').textContent = total;
            document.getElementById('convertedReferrals').textContent = converted;
            document.getElementById('pendingReferrals').textContent = pending;
            document.getElementById('totalToPay').textContent = `R$ ${totalToPay}`;
        }

        // Carregar indica√ß√µes na tabela
        function loadReferrals() {
            const referrals = JSON.parse(localStorage.getItem('referrals')) || [];
            const tbody = document.getElementById('referralsTableBody');
            
            tbody.innerHTML = '';

            if (referrals.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 20px;">
                            Nenhuma indica√ß√£o encontrada...
                        </td>
                    </tr>
                `;
                return;
            }

            referrals.forEach(referral => {
                const row = document.createElement('tr');
                
                let statusClass = 'status-pending';
                let statusText = 'Pendente';

                if (referral.status === 'contracted') {
                    statusClass = 'status-contracted';
                    statusText = 'Contrato Pago';
                } else if (referral.status === 'paid') {
                    statusClass = 'status-converted';
                    statusText = 'Pago';
                }
                
                let actions = '';
                if (referral.status === 'pending') {
                    actions = `<button class="btn-action btn-convert" onclick="closeContract(${referral.id})">Contrato Pago</button>
                               <button class="btn-action btn-cancel" onclick="cancelReferral(${referral.id})">Cancelar</button>`;
                } else if (referral.status === 'contracted') {
                    actions = `<button class="btn-action btn-convert" onclick="markAsPaid(${referral.id})">Marcar como Pago</button>`;
                } else if (referral.status === 'paid') {
                    actions = `<span style="color: #28a745;">‚úÖ Pago em ${referral.paymentDate}</span>`;
                }
                
                row.innerHTML = `
                    <td>${referral.id}</td>
                    <td>${referral.referrerName}</td>
                    <td>${referral.referrerPhone}</td>
                    <td>${referral.friendName}</td>
                    <td>${referral.friendPhone}</td>
                    <td>${referral.date}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>${actions}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Fechar contrato
        function closeContract(id) {
            let referrals = JSON.parse(localStorage.getItem('referrals')) || [];
            const referral = referrals.find(r => r.id === id);
            
            if (referral) {
                referral.status = 'contracted';
                localStorage.setItem('referrals', JSON.stringify(referrals));
                loadStats();
                loadReferrals();
                loadRecentActivity(); 
                alert('‚úÖ Contrato Pago! Agora voc√™ deve pagar o PIX de R$ 30,00 üí∞ para quem indicou!.');
            }
        }

        // Marcar como pago
        function markAsPaid(id) {
    let referrals = JSON.parse(localStorage.getItem('referrals')) || [];
    const referral = referrals.find(r => r.id === id);
    
    if (referral) {
        referral.status = 'paid';
        referral.paymentDate = new Date().toLocaleDateString('pt-BR');
        localStorage.setItem('referrals', JSON.stringify(referrals));
        loadStats();
        loadReferrals();
        loadRecentActivity(); // ESTA LINHA √â NOVA
        alert('üí∞ Pagamento registrado com sucesso!');
    }
}

        // Cancelar indica√ß√£o
        function cancelReferral(id) {
            if (confirm('‚ùå Tem certeza que deseja cancelar esta indica√ß√£o?')) {
                let referrals = JSON.parse(localStorage.getItem('referrals')) || [];
                referrals = referrals.filter(r => r.id !== id);
                localStorage.setItem('referrals', JSON.stringify(referrals));
                loadStats();
                loadReferrals();
                alert('‚ùå Indica√ß√£o cancelada!');
            }
        }

        // Mostrar se√ß√£o
        function showSection(sectionName) {
            // Esconder todas as se√ß√µes
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover active dos bot√µes
            const buttons = document.querySelectorAll('.admin-nav button');
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Mostrar se√ß√£o selecionada
            document.getElementById(sectionName + 'Section').classList.add('active');
            
            // Marcar bot√£o como ativo
            event.target.classList.add('active');
            
            // Recarregar dados se necess√°rio
if (sectionName === 'referrals') {
    loadReferrals();
} else if (sectionName === 'payments') {
    loadPayments();
}
        }

        // Salvar configura√ß√µes
        function saveSettings() {
            alert('‚úÖ Configura√ß√µes salvas com sucesso!');
        }

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            if (isLoggedIn) {
                showDashboard();
            } else {
                showLogin();
            }
        });
    // Carregar pagamentos
function loadPayments() {
    const referrals = JSON.parse(localStorage.getItem('referrals')) || [];
    const paidReferrals = referrals.filter(r => r.status === 'paid');
    const contractedReferrals = referrals.filter(r => r.status === 'contracted');
    
    const tbody = document.getElementById('paymentsTableBody');
    const totalPaidAmount = paidReferrals.length * 30;
    const pendingPaymentAmount = contractedReferrals.length * 30;
    
    // Atualizar resumo financeiro
    document.getElementById('totalPaidAmount').textContent = totalPaidAmount;
    document.getElementById('pendingPaymentAmount').textContent = pendingPaymentAmount;
    
    tbody.innerHTML = '';

    if (paidReferrals.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="7" style="text-align: center; padding: 20px;">
                    Nenhum pagamento encontrado...
                </td>
            </tr>
        `;
        return;
    }

    paidReferrals.forEach(referral => {
        const row = document.createElement('tr');
        
        row.innerHTML = `
            <td>${referral.id}</td>
            <td>${referral.referrerName}</td>
            <td>${referral.referrerPhone}</td>
            <td>${referral.friendName}</td>
            <td>R$ 30,00</td>
            <td>${referral.paymentDate}</td>
            <td><span class="status-converted">‚úÖ Pago</span></td>
        `;
        
        tbody.appendChild(row);
    });
}
    // Reset apenas das indica√ß√µes
function resetAllData() {
    const confirmation = confirm('üö® ATEN√á√ÉO!\n\nIsso vai apagar TODAS as indica√ß√µes do sistema!\n\nTem certeza que deseja continuar?');
    
    if (confirmation) {
        const doubleConfirmation = confirm('‚ö†Ô∏è √öLTIMA CHANCE!\n\nEsta a√ß√£o N√ÉO PODE SER DESFEITA!\n\nConfirma a exclus√£o de todas as indica√ß√µes?');
        
        if (doubleConfirmation) {
            localStorage.removeItem('referrals');
            loadStats();
            loadReferrals();
            loadPayments();
            alert('üóëÔ∏è Todas as indica√ß√µes foram apagadas com sucesso!');
        }
    }
}

// Reset completo do sistema
function resetSystem() {
    const confirmation = confirm('üö® PERIGO!\n\nIsso vai apagar TUDO:\n- Todas as indica√ß√µes\n- Todas as configura√ß√µes\n- Hist√≥rico de pagamentos\n\nTem certeza que deseja continuar?');
    
    if (confirmation) {
        const doubleConfirmation = confirm('‚ö†Ô∏è √öLTIMA CHANCE!\n\nEsta a√ß√£o vai RESETAR COMPLETAMENTE o sistema!\n\nN√ÉO PODER√Å SER DESFEITA!\n\nConfirma o reset total?');
        
        if (doubleConfirmation) {
            // Limpar todos os dados
            localStorage.clear();
            
            // Fazer logout
            alert('üîÑ Sistema resetado com sucesso!\n\nVoc√™ ser√° deslogado agora.');
            logout();
        }
    }
}
// Carregar √∫ltimas atividades
function loadRecentActivity() {
    const referrals = JSON.parse(localStorage.getItem('referrals')) || [];
    const activityDiv = document.getElementById('recentActivity');
    
    if (referrals.length === 0) {
        activityDiv.innerHTML = '<p>Nenhuma atividade recente...</p>';
        return;
    }
    
    // Ordenar por ID (mais recentes primeiro)
    const sortedReferrals = referrals.sort((a, b) => b.id - a.id);
    
    // Pegar as √∫ltimas 5 atividades
    const recentReferrals = sortedReferrals.slice(0, 5);
    
    let activityHTML = '';
    
    recentReferrals.forEach(referral => {
        let statusIcon = '';
        let statusText = '';
        let statusColor = '';
        
        if (referral.status === 'pending') {
            statusIcon = '‚è≥';
            statusText = 'Nova indica√ß√£o recebida';
            statusColor = '#ffc107';
        } else if (referral.status === 'contracted') {
            statusIcon = '‚úÖ';
            statusText = 'Contrato fechado';
            statusColor = '#17a2b8';
        } else if (referral.status === 'paid') {
            statusIcon = 'üí∞';
            statusText = `Pagamento realizado em ${referral.paymentDate}`;
            statusColor = '#28a745';
        }
        
        activityHTML += `
            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid ${statusColor}; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.2rem;">${statusIcon}</span>
                    <div>
                        <strong>${statusText}</strong><br>
                        <span style="color: #666; font-size: 0.9rem;">
                            ${referral.referrerName} indicou ${referral.friendName} - ${referral.date}
                        </span>
                    </div>
                </div>
            </div>
        `;
    });
    
    activityDiv.innerHTML = activityHTML;
}
    </script>
</body>
</html>